{% extends "edit/base.jinja" %}
{% block content %}

<div>
    <h1 class="pb-4">Editing Cast</h1>
</div>

<form method="POST" action="">
    <div class="card mb-4">
        <div class="card-header bg-primary text-white">
            Add New Role
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-8 mb-3">
                    <label class="form-label">Role Name</label>
                    <input type="text" class="form-control" name="new_role_name">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="form-label">Is Group?</label>
                    <select class="form-select" name="new_role_is_group">
                        <option value="0">No - Individual</option>
                        <option value="1">Yes - Group Role</option>
                    </select>
                </div>
                <div class="col-md-12 mb-3">
                    <label class="form-label">Assign Students to This Role</label>
                    <select class="form-select" name="new_role_students[]" multiple size="6">
                        {% for student in students %}
                            <option value="{{ student.id }}">{{ student.name }}</option>
                        {% endfor %}
                    </select>
                    <small class="text-muted">Hold Ctrl (Windows) / Cmd (Mac) to select multiple.</small>
                </div>
            </div>
        </div>
    </div>
    {% for role in roles %}
    <div class="card mb-4">
        <div class="card-header d-flex justify-content-between align-items-center">
            <strong>{{ role.name }}</strong>
            {% if role.is_group %}
                <span class="badge bg-secondary">Group Role</span>
            {% endif %}
        </div>

        <div class="card-body">
            <div class="mb-3">
                <label class="form-label">Rename Role</label>
                <input type="text" class="form-control" name="role_name_{{ role.id }}" value="{{ role.name }}">
            </div>

            <label class="form-label">Assigned Students</label>
            <select name="role_students_{{ role.id }}[]" class="form-select" multiple size="6">
                {% for student in students %}
                    <option value="{{ student.id }}" {% if student in role.students %} selected {% endif %}>
                        {{ student.name }}
                    </option>
                {% endfor %}
            </select>
            
            <div class="mt-3 text-end">
                <button name="delete_role" value="{{ role.id }}" class="btn btn-danger btn-sm">
                    Delete Role
                </button>
            </div>
        </div>
    </div>
    {% endfor %}
    
    <div class="pb-5 mt-4">
        <button class="p-3 btn btn-primary w-100">Save Changes</button>
    </div>
</form>

{% endblock %}
